<!DOCTYPE html>
<html lang="zh-cn">
  <head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noodp"/>
  <meta name="author" content="周啟尧">
  
  
  
  <link rel="prev" href="https://chow1027.xyz/2020/%E6%95%B0%E7%BB%84%E6%89%81%E5%B9%B3%E5%8C%96%E7%9A%84%E6%96%B9%E6%B3%95/" />
  
  <link rel="canonical" href="https://chow1027.xyz/2020/http%E7%BC%93%E5%AD%98/" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <title>
       
       
           HTTP缓存 | 呆尬猴的博客
       
  </title>
  <meta name="title" content="HTTP缓存 | 呆尬猴的博客">
    
  
  <link rel="stylesheet" href="/font/iconfont.css">
  <link rel="stylesheet" href="/css/main.min.css">


  
  
 

<script type="application/ld+json">
 "@context" : "http://schema.org",
    "@type" : "BlogPosting",
    "mainEntityOfPage": {
         "@type": "WebPage",
         "@id": "https:\/\/chow1027.xyz"
    },
    "articleSection" : "posts",
    "name" : "HTTP缓存",
    "headline" : "HTTP缓存",
    "description" : "HTTP 缓存首部字段  Cache-Control Pragma If-Match If-None-Match If-Modified-Since If-Unmodified-Since Etag Expires Last-Modified  总的来说，HTTP 缓存分为強缓存和协商缓存。\n強缓存包括：Pragma，Expires，Cache-Control，用来决定是否缓存、缓存时间、缓存行为，他们的优先级顺序是：Pragma \x26gt; Cache-Control \x26gt; Expires。\n协商缓存包括：Etag 和 Last-Modified，用来决定资源是否更新，是否使用缓存。\n其中与 Etag 相关的两个字段是 If-Match，If-None-Match。\n与 Last-Modified 相关的两个字段是 If-Modified-Since，If-UnModified-Since。\n1. Pragma 通用首部字段，可以在请求报文和响应报文中使用。\n当该字段为 no-cache 时，表示不要对该资源读取缓存，每次都要向服务器发送请求。\n2. Expires 定义缓存过期的时间，由于是相对于服务器的时间而言，因此如果客户端的时间发生错乱就会出现问题（比如用户更改了系统时间）\n3. Cache-Control 控制缓存行为。\n与 Expires 不同，Cache-Control 定义的是过期时长，比如 max-age=3600 表示一小时后过期。\nCache-Control 具有多个选项，同时也是一个通用首部字段，可以在请求报文和响应报文中使用。\n当作为请求首部时： no-cache 不直接使用缓存，向原服务器发起请求\nno-store 所有内容都不会保存到缓存或 Internet 临时文件中\nmax-age 告知服务器客户端希望接受一个有效时间为 max-age 的资源\nmax-stale 告知服务器客户端愿意接受一个超过缓存时间为 max-scale 的资源\nmin-fresh 告知服务器表示客户端希望接受一个在 min-fresh 秒内被更新过的资源。",
    "inLanguage" : "zh-cn",
    "author" : "周啟尧",
    "creator" : "周啟尧",
    "publisher": "周啟尧",
    "accountablePerson" : "周啟尧",
    "copyrightHolder" : "周啟尧",
    "copyrightYear" : "2020",
    "datePublished": "2020-04-16 22:02:00 \x2b0800 CST",
    "dateModified" : "2020-04-16 22:02:00 \x2b0800 CST",
    "url" : "https:\/\/chow1027.xyz\/2020\/http%E7%BC%93%E5%AD%98\/",
    "wordCount" : "158",
    "keywords" : [ "HTTP", "呆尬猴的博客"]
}
</script>

</head>

  


  <body class="">
    <div class="wrapper">
        <nav class="navbar">
    <div class="container">
        <div class="navbar-header header-logo">
        	<a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href="https://chow1027.xyz">呆尬猴的博客</a>
        </div>
        <div class="menu navbar-right">
                
                
                <a class="menu-item" href="/posts/" title="">博客</a>
                
                <a class="menu-item" href="/categories/" title="">目录</a>
                
                <a class="menu-item" href="/tags/" title="">标签</a>
                
                <a class="menu-item" href="/about/" title="">About</a>
                
        </div>
    </div>
</nav>
<nav class="navbar-mobile" id="nav-mobile" style="display: none">
     <div class="container">
        <div class="navbar-header">
            <div>  <a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href="https://chow1027.xyz">呆尬猴的博客</a></div>
            <div class="menu-toggle">
                <span></span><span></span><span></span>
            </div>
        </div>
     
          <div class="menu" id="mobile-menu">
                
                
                <a class="menu-item" href="/posts/" title="">博客</a>
                
                <a class="menu-item" href="/categories/" title="">目录</a>
                
                <a class="menu-item" href="/tags/" title="">标签</a>
                
                <a class="menu-item" href="/about/" title="">About</a>
                
        </div>
    </div>
</nav>
    	 <main class="main">
          <div class="container">
      		
<article class="post-warp" itemscope itemtype="http://schema.org/Article">
    <header class="post-header">
        <h1 class="post-title" itemprop="name headline">HTTP缓存</h1>
        <div class="post-meta">
                Written by <a itemprop="name" href="https://chow1027.xyz" rel="author">周啟尧</a> with ♥ 
                <span class="post-time">
                on <time datetime=2020-04-16 itemprop="datePublished">April 16, 2020</time>
                </span>
                in
                <i class="iconfont icon-folder"></i>
                <span class="post-category">
                        <a href="https://chow1027.xyz/categories/browser/"> Browser </a>
                        
                </span>
        </div>
    </header>
    <div class="post-content">
        

        

        
        
     
          
          
          

          
          
          

          <h2 id="http-缓存首部字段">HTTP 缓存首部字段</h2>
<ul>
<li>Cache-Control</li>
<li>Pragma</li>
<li>If-Match</li>
<li>If-None-Match</li>
<li>If-Modified-Since</li>
<li>If-Unmodified-Since</li>
<li>Etag</li>
<li>Expires</li>
<li>Last-Modified</li>
</ul>
<p>总的来说，HTTP 缓存分为強缓存和协商缓存。</p>
<p>強缓存包括：Pragma，Expires，Cache-Control，用来决定是否缓存、缓存时间、缓存行为，他们的优先级顺序是：Pragma &gt; Cache-Control &gt; Expires。</p>
<p>协商缓存包括：Etag 和 Last-Modified，用来决定资源是否更新，是否使用缓存。</p>
<p>其中与 Etag 相关的两个字段是 If-Match，If-None-Match。</p>
<p>与 Last-Modified 相关的两个字段是 If-Modified-Since，If-UnModified-Since。</p>
<h3 id="1-pragma">1. Pragma</h3>
<p>通用首部字段，可以在请求报文和响应报文中使用。</p>
<p>当该字段为 no-cache 时，表示不要对该资源读取缓存，每次都要向服务器发送请求。</p>
<h3 id="2-expires">2. Expires</h3>
<p>定义缓存过期的时间，由于是相对于服务器的时间而言，因此如果客户端的时间发生错乱就会出现问题（比如用户更改了系统时间）</p>
<h3 id="3-cache-control">3. Cache-Control</h3>
<p>控制缓存行为。</p>
<p>与 Expires 不同，Cache-Control 定义的是过期时长，比如 max-age=3600 表示一小时后过期。</p>
<p>Cache-Control 具有多个选项，同时也是一个通用首部字段，可以在请求报文和响应报文中使用。</p>
<h4 id="当作为请求首部时">当作为请求首部时：</h4>
<p>no-cache 不直接使用缓存，向原服务器发起请求</p>
<p>no-store 所有内容都不会保存到缓存或 Internet 临时文件中</p>
<p>max-age 告知服务器客户端希望接受一个有效时间为 max-age 的资源</p>
<p>max-stale 告知服务器客户端愿意接受一个超过缓存时间为 max-scale 的资源</p>
<p>min-fresh 告知服务器表示客户端希望接受一个在 min-fresh 秒内被更新过的资源。</p>
<p>no-transform 表示客户端希望获取实体数据没有被转换（压缩）过的资源</p>
<p>only-if-cached 表示客户端希望获取缓存的内容而不用请求原服务器</p>
<h4 id="当作为响应首部时">当作为响应首部时：</h4>
<p>public 表示任何情况下都要缓存该资源</p>
<p>Private 表明返回报文中的部分或全部仅开放给某些用户做缓存使用，其他用户不能缓存这些数据</p>
<p>no-cache 不直接使用缓存，要求向服务器发起新鲜度校验请求</p>
<p>no-store 所有内容都不会保存到缓存或 Internet 临时文件中</p>
<p>only-if-cached 表示客户端希望获取缓存的内容而不用请求原服务器</p>
<p>must-revalidate 表示当前资源一定是向原服务器发去验证请求的，如果请求失败会返回 504</p>
<p>proxy-revalidate 与 must-revalidate 类似，但仅限于共享缓存</p>
<p>max-age 告诉客户端资源在 max-age 的时间内是新的，不需要向服务器发请求</p>
<p>s-maxage 与 max-age 类似，但仅限于共享缓存</p>
<h3 id="4-last-modified">4. Last-Modified</h3>
<p>是实体首部字段。</p>
<p>标记了（实体）资源的最后更改时间，在客户端下一次发起请求的时候，会将该信息附带在请求报文（If-Modified-Since/If-Unmodified-Since）中一并带给服务器检查。</p>
<p>如果传递的时间值与服务器上该资源的最终修改时间一致，表示该资源没有更新，直接返回 304 状态码，内容为空，从而节省了数据传输量。</p>
<p>如果时间不一致，则返回 200 状态码。</p>
<h4 id="if-modified-since">If-Modified-Since</h4>
<p>请求首部，告诉服务器端如果客户端传来的最后修改时间与服务器上的一致，则直接会送 304 个响应报头即可。</p>
<h4 id="if-unmodified-since">If-Unmodified-Since</h4>
<p>告诉服务器如果 Last-Modified 没有匹配上，应当返回 412 状态码给客户端。
【412（先决条件失败）表示客户端错误，意味着对于目标资源的访问请求被拒绝。】</p>
<p>Last-Modified 存在一定问题，如果在服务器上一个资源修改了，但实际内容并没有发生改变，也会因为 Last-Modified 匹配不上而重新返回整个实体给客户端。</p>
<h3 id="5-etag">5. Etag</h3>
<p>Etag 实体首部字段解决了 Last-Modified 可能存在的不准确的问题。</p>
<p>服务器通过某种算法给资源计算得出的一个唯一标识符就是 Etag。当服务器把资源相应给客户端的时候，会在实体首部添加 Etag。</p>
<p>类似 Last-Modified，客户端会在下次请求时带上 Etag。服务器通过比较客户端传来的 Etag 和自己服务器上资源的 Etag 是否一致，判断该资源是否更新。</p>
<p>Etag 匹配不上表示资源更新，服务器将新的 Etag 和资源发给客户端，否则返回 304 告诉客户端使用本地缓存。</p>
<h4 id="if-none-match">If-None-Match</h4>
<p>请求首部，告诉服务器如果 Etag 匹配不上需要重发资源数据，否则直接回送 304 和请求报头。</p>
<h4 id="if-match">If-Match</h4>
<p>告诉服务器如果没有收到 Etag，或者收到了&rsquo;*&lsquo;值而当前没有该资源实体，则返回 412 状态码。否则服务器直接忽略该字段。</p>

    </div>

    <div class="post-copyright">
             
            <p class="copyright-item">
                <span>Author:</span>
                <span>周啟尧 </span>
                </p>
            
           
             
            <p class="copyright-item">
                    <span>Link:</span>
                    <a href=https://chow1027.xyz/2020/http%E7%BC%93%E5%AD%98/>https://chow1027.xyz/2020/http%E7%BC%93%E5%AD%98/</span>
            </p>
            
             
            <p class="copyright-item lincese">
                本文采用<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可
            </p>
            
    </div>

  
    <div class="post-tags">
        
            <section>
            <i class="iconfont icon-tag"></i>Tag(s): 
            
            <span class="tag"><a href="https://chow1027.xyz/tags/http/">
                    #HTTP</a></span>
            
            </section>
        
        <section>
                <a href="javascript:window.history.back();">back</a></span> · 
                <span><a href="https://chow1027.xyz">home</a></span>
        </section>
    </div>

    <div class="post-nav">
        
        <a href="https://chow1027.xyz/2020/%E6%95%B0%E7%BB%84%E6%89%81%E5%B9%B3%E5%8C%96%E7%9A%84%E6%96%B9%E6%B3%95/" class="prev" rel="prev" title="数组扁平化的方法"><i class="iconfont icon-left"></i>&nbsp;数组扁平化的方法</a>
         
        
    </div>

    <div class="post-comment">
          
                 
          
    </div>
</article>
          </div>
		   </main>
      <footer class="footer">
    <div class="copyright">
        &copy;
        
        <span itemprop="copyrightYear">2019 - 2020</span>
        
        <span class="with-love">
    	 <i class="iconfont icon-love"></i> 
         </span>
         
            <span class="author" itemprop="copyrightHolder"><a href="https://chow1027.xyz">周啟尧</a> | </span> 
         

         
		  <span>Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow">Hugo</a> & <a href="https://github.com/liuzc/leaveit" target="_blank" rel="external nofollow">LeaveIt</a></span> 
    </div>
</footer>












    
    
    <script src="/js/vendor_no_gallery.min.js" async=""></script>
    
  



     </div>
  </body>
</html>
